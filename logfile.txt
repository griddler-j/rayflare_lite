1:wavelengths = np.arange(300,1201,5) * 1e-9
2:options["wavelength"] = wavelengths
3:options["n_theta_bins"] = 30
4:options["I_thresh"] = 0.01
5:options["only_incidence_angle"] = True
6:options["theta_in"] = 0
7:options["phi_in"] = 0
8:front_materials = []
9:rear_materials = []
10:base_material = create_new_material("Si", "temp/1-Si.txt")
11:cell_bulk = BulkLayer(0.018*1e-2, base_material, name="cell_bulk")
12:top_medium = create_new_material("air", "temp/2-air.txt")
13:bottom_medium = create_new_material("air", "temp/3-air.txt")
14:layer = create_new_layer("SiNx_PECVD_1.92", 45, "temp/4-SiNx_PECVD_1.92.txt", k_file_path=None)
15:front_materials.append(layer)
16:layer = create_new_layer("SiNx_PECVD_2.37", 15, "temp/5-SiNx_PECVD_2.37.txt", k_file_path=None)
17:front_materials.append(layer)
18:layer = create_new_layer("Al2O3", 20, "temp/6-Al2O3.txt", k_file_path=None)
19:front_materials.append(layer)
20:layer = create_new_layer("SiO2", 2, "temp/7-SiO2.txt", k_file_path=None)
21:rear_materials.append(layer)
22:layer = create_new_layer("poly-Si", 100, "temp/8-poly-Si.txt", k_file_path=None)
23:rear_materials.append(layer)
24:layer = create_new_layer("SiNx_PECVD_1.92", 100, "temp/9-SiNx_PECVD_1.92.txt", k_file_path=None)
25:rear_materials.append(layer)
26:top_cover_front_materials = []
27:top_cover_rear_materials = []
28:bottom_cover_front_materials = []
29:bottom_cover_rear_materials = []
30:top_cover_bulk = None
31:bottom_cover_bulk = None
32:surf = regular_pyramids(elevation_angle=54.7357, upright=True, random_positions=True)
33:surf_back = planar_surface()
34:front_roughness = Roughness(0.34907)
35:rear_roughness = None
36:front_angular_distribution = [[1,0,0,0],[0,0,0,0]]
37:rear_angular_distribution = [[1,0,0,0],[0,0,0,0]]
38:front_results, rear_results = run_simulation(top_medium, bottom_medium, front_materials, front_roughness, rear_materials, rear_roughness, surf, surf_back, cell_bulk, [],[],[],[1,2],[],[], top_cover_bulk, top_cover_front_materials, top_cover_rear_materials, bottom_cover_bulk, bottom_cover_front_materials, bottom_cover_rear_materials,0,0,0,0,1,front_angular_distribution,1,rear_angular_distribution,"temp/front_output.txt","temp/rear_output.txt",True)
39:layer_thickness = 2
40:z_front = np.array([0,0.02,0.04,0.06,0.08,0.1,0.12,0.14,0.16,0.18,0.2,0.22,0.24,0.26,0.28,0.3,0.32,0.34,0.36,0.38,0.4,0.42,0.44,0.46,0.48,0.5,0.52,0.54,0.56,0.58,0.6,0.62,0.64,0.66,0.68,0.7,0.72,0.74,0.76,0.78,0.8,0.82,0.84,0.86,0.88,0.9,0.92,0.94,0.96,0.98,1,1.02,1.04,1.06,1.08,1.1,1.12,1.14,1.16,1.18,1.2,1.22,1.24,1.26,1.28,1.3,1.32,1.34,1.36,1.38,1.4,1.42,1.44,1.46,1.48,1.5,1.52,1.54,1.56,1.58,1.6,1.62,1.64,1.66,1.68,1.7,1.72,1.74,1.76,1.78,1.8,1.82,1.84,1.86,1.88,1.9,1.92,1.94,1.96,1.98,2])
41:layer_profile(front_results, z_front, 3,0,"temp/layer4-1_absorption_profile.txt")
42:layer_thickness = 100
43:z_front = np.array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100])
44:layer_profile(front_results, z_front, 3,1,"temp/layer4-2_absorption_profile.txt")
45:Si_thickness = 180
46:z_front = np.array([0,0,1.8,3.6,5.4,7.2,9,10.8,12.6,14.4,16.2,18,19.8,21.6,23.4,25.2,27,28.8,30.6,32.4,34.2,36,37.8,39.6,41.4,43.2,45,46.8,48.6,50.4,52.2,54,55.8,57.6,59.4,61.2,63,64.8,66.6,68.4,70.2,72,73.8,75.6,77.4,79.2,81,82.8,84.6,86.4,88.2,90,91.8,93.6,95.4,97.2,99,100.8,102.6,104.4,106.2,108,109.8,111.6,113.4,115.2,117,118.8,120.6,122.4,124.2,126,127.8,129.6,131.4,133.2,135,136.8,138.6,140.4,142.2,144,145.8,147.6,149.4,151.2,153,154.8,156.6,158.4,160.2,162,163.8,165.6,167.4,169.2,171,172.8,174.6,176.4,178.2,180])
47:bulk_profile(front_results, z_front, "temp/substrate_absorption_profile.txt")
48:layer_thickness = 2
49:z_front = np.array([0,0.02,0.04,0.06,0.08,0.1,0.12,0.14,0.16,0.18,0.2,0.22,0.24,0.26,0.28,0.3,0.32,0.34,0.36,0.38,0.4,0.42,0.44,0.46,0.48,0.5,0.52,0.54,0.56,0.58,0.6,0.62,0.64,0.66,0.68,0.7,0.72,0.74,0.76,0.78,0.8,0.82,0.84,0.86,0.88,0.9,0.92,0.94,0.96,0.98,1,1.02,1.04,1.06,1.08,1.1,1.12,1.14,1.16,1.18,1.2,1.22,1.24,1.26,1.28,1.3,1.32,1.34,1.36,1.38,1.4,1.42,1.44,1.46,1.48,1.5,1.52,1.54,1.56,1.58,1.6,1.62,1.64,1.66,1.68,1.7,1.72,1.74,1.76,1.78,1.8,1.82,1.84,1.86,1.88,1.9,1.92,1.94,1.96,1.98,2])
50:layer_profile(rear_results, z_front, 3,0,"temp/layer4-1_absorption_profile.txt")
51:layer_thickness = 100
52:z_front = np.array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100])
53:layer_profile(rear_results, z_front, 3,1,"temp/layer4-2_absorption_profile.txt")
54:Si_thickness = 180
55:z_front = np.array([0,0,1.8,3.6,5.4,7.2,9,10.8,12.6,14.4,16.2,18,19.8,21.6,23.4,25.2,27,28.8,30.6,32.4,34.2,36,37.8,39.6,41.4,43.2,45,46.8,48.6,50.4,52.2,54,55.8,57.6,59.4,61.2,63,64.8,66.6,68.4,70.2,72,73.8,75.6,77.4,79.2,81,82.8,84.6,86.4,88.2,90,91.8,93.6,95.4,97.2,99,100.8,102.6,104.4,106.2,108,109.8,111.6,113.4,115.2,117,118.8,120.6,122.4,124.2,126,127.8,129.6,131.4,133.2,135,136.8,138.6,140.4,142.2,144,145.8,147.6,149.4,151.2,153,154.8,156.6,158.4,160.2,162,163.8,165.6,167.4,169.2,171,172.8,174.6,176.4,178.2,180])
56:bulk_profile(rear_results, z_front, "temp/substrate_absorption_profile.txt")
57:exit
